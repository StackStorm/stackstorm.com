<!DOCTYPE html>
<html lang="en-US">
<head>
	<style type="text/css">.ttfm1{font-family: 'dual300';font-size:em;line-height:em;color:;}  .ttfm2{font-family: 'Roboto';font-size:em;line-height:3em;color:;}</style>	<!--[if lt IE 9]>
	<script src="../../../../wp/wp-content/themes/rise/js/html5/dist/html5shiv.js"></script>
	<script src="//css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
	<![endif]-->
	<!--[if IE 8]>
	<link rel="stylesheet" type="text/css" href="../../../../wp/wp-content/themes/rise/css/ie8.css"/>
	<![endif]-->
	<!--[if IE 7]>
	<link rel="stylesheet" type="text/css" href="../../../../wp/wp-content/themes/rise/css/ie7.css"/>
	<![endif]-->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta charset="UTF-8">
	
			<meta name="google-site-verification" content="ovwnX0ej2kps4UuJ9NOzNjJcLOQD8JPDLNhe-hMYTMk">	
		<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

	<!-- This site is optimized with the Yoast SEO plugin v16.4 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>StackStorm - Automated Troubleshooting - StackStorm</title>
	<link rel="canonical" href="./index.html">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="StackStorm - Automated Troubleshooting - StackStorm">
	<meta property="og:description" content="READ MORE">
	<meta property="og:url" content="/2014/11/25/stackstorm-automated-troubleshooting/">
	<meta property="og:site_name" content="StackStorm">
	<meta property="article:published_time" content="2014-11-25T05:32:24+00:00">
	<meta property="article:modified_time" content="2019-06-14T21:01:13+00:00">
	<meta property="og:image" content="../../../../wp/wp-content/uploads/2014/11/Image-from-chat2.jpg">
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="st2admin">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="17 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"/#organization","name":"StackStorm","url":"/","sameAs":[],"logo":{"@type":"ImageObject","@id":"/#logo","inLanguage":"en-US","url":"../../../../wp/wp-content/uploads/2014/10/stackstorm-logo-header.png","contentUrl":"../../../../wp/wp-content/uploads/2014/10/stackstorm-logo-header.png","width":228,"height":59,"caption":"StackStorm"},"image":{"@id":"/#logo"}},{"@type":"WebSite","@id":"/#website","url":"/","name":"StackStorm","description":"Event-driven automation","publisher":{"@id":"/#organization"},"potentialAction":[{"@type":"SearchAction","target":"/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"/2014/11/25/stackstorm-automated-troubleshooting/#primaryimage","inLanguage":"en-US","url":"../../../../wp/wp-content/uploads/2014/11/Image-from-chat2.jpg","contentUrl":"../../../../wp/wp-content/uploads/2014/11/Image-from-chat2.jpg"},{"@type":"WebPage","@id":"/2014/11/25/stackstorm-automated-troubleshooting/#webpage","url":"/2014/11/25/stackstorm-automated-troubleshooting/","name":"StackStorm - Automated Troubleshooting - StackStorm","isPartOf":{"@id":"/#website"},"primaryImageOfPage":{"@id":"/2014/11/25/stackstorm-automated-troubleshooting/#primaryimage"},"datePublished":"2014-11-25T05:32:24+00:00","dateModified":"2019-06-14T21:01:13+00:00","breadcrumb":{"@id":"/2014/11/25/stackstorm-automated-troubleshooting/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["/2014/11/25/stackstorm-automated-troubleshooting/"]}]},{"@type":"BreadcrumbList","@id":"/2014/11/25/stackstorm-automated-troubleshooting/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"/blog/","url":"/blog/","name":"Blog"}},{"@type":"ListItem","position":3,"item":{"@id":"/2014/11/25/stackstorm-automated-troubleshooting/#webpage"}}]},{"@type":"Article","@id":"/2014/11/25/stackstorm-automated-troubleshooting/#article","isPartOf":{"@id":"/2014/11/25/stackstorm-automated-troubleshooting/#webpage"},"author":{"@id":"/#/schema/person/d2242d1dc5b3b5652be4c9175eb18000"},"headline":"StackStorm &#8211; Automated Troubleshooting","datePublished":"2014-11-25T05:32:24+00:00","dateModified":"2019-06-14T21:01:13+00:00","mainEntityOfPage":{"@id":"/2014/11/25/stackstorm-automated-troubleshooting/#webpage"},"wordCount":2248,"commentCount":0,"publisher":{"@id":"/#organization"},"image":{"@id":"/2014/11/25/stackstorm-automated-troubleshooting/#primaryimage"},"thumbnailUrl":"../../../../wp/wp-content/uploads/2014/11/Image-from-chat2.jpg","keywords":["chatops","sensu","troubleshooting"],"articleSection":["Blog","Community","Home"],"inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["/2014/11/25/stackstorm-automated-troubleshooting/#respond"]}]},{"@type":"Person","@id":"/#/schema/person/d2242d1dc5b3b5652be4c9175eb18000","name":"st2admin","image":{"@type":"ImageObject","@id":"/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/67f6d678610d4b8a7b9a7e95a065695f?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/67f6d678610d4b8a7b9a7e95a065695f?s=96&d=mm&r=g","caption":"st2admin"},"url":"/author/support/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="//s.w.org">
<link rel="alternate" type="application/rss+xml" title="StackStorm &raquo; StackStorm &#8211; Automated Troubleshooting Comments Feed" href="/2014/11/25/stackstorm-automated-troubleshooting/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp\/wp-includes\/js\/wp-emoji-release.min.js?ver=09e48cfb58fec140b4ee0c6d1d4da1b2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style>
	<link rel="stylesheet" id="dashicons-css" href="../../../../wp/wp-includes/css/dashicons.min.css?ver=09e48cfb58fec140b4ee0c6d1d4da1b2" type="text/css" media="all">
<link rel="stylesheet" id="menu-icons-extra-css" href="../../../../wp/wp-content/plugins/menu-icons/css/extra.min.css?ver=0.12.8" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="../../../../wp/wp-includes/css/dist/block-library/style.min.css?ver=09e48cfb58fec140b4ee0c6d1d4da1b2" type="text/css" media="all">
<link rel="stylesheet" id="cookie-law-info-css" href="../../../../wp/wp-content/plugins/cookie-law-info/public/css/cookie-law-info-public.css?ver=2.0.3" type="text/css" media="all">
<link rel="stylesheet" id="cookie-law-info-gdpr-css" href="../../../../wp/wp-content/plugins/cookie-law-info/public/css/cookie-law-info-gdpr.css?ver=2.0.3" type="text/css" media="all">
<link rel="stylesheet" id="testimonial-rotator-style-css" href="../../../../wp/wp-content/plugins/testimonial-rotator/testimonial-rotator-style.css?ver=09e48cfb58fec140b4ee0c6d1d4da1b2" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-css" href="../../../../wp/wp-content/plugins/menu-icons/vendor/codeinwp/icon-picker/css/types/font-awesome.min.css?ver=4.7.0" type="text/css" media="all">
<link rel="stylesheet" id="rise-style-css" href="../../../../wp/wp-content/themes/stackstorm/style.css?ver=09e48cfb58fec140b4ee0c6d1d4da1b2" type="text/css" media="all">
<link rel="stylesheet" id="thrive-reset-css" href="../../../../wp/wp-content/themes/rise/css/reset.css?v=1.101.1" type="text/css" media="all">
<link rel="stylesheet" id="thrive-main-style-css" href="../../../../wp/wp-content/themes/rise/css/main_blue.css?v=1.101.1" type="text/css" media="all">
<link rel="stylesheet" id="enlighterjs-css" href="../../../../wp/wp-content/plugins/enlighter/cache/enlighterjs.min.css?ver=c8vUwCl5jS8Iu00" type="text/css" media="all">
<script type="text/javascript" src="../../../../wp/wp-includes/js/jquery/jquery.min.js?v=1.101.1" id="jquery-core-js"></script>
<script type="text/javascript" src="../../../../wp/wp-includes/js/jquery/jquery-migrate.min.js?v=1.101.1" id="jquery-migrate-js"></script>
<script type="text/javascript" id="cookie-law-info-js-extra">
/* <![CDATA[ */
var Cli_Data = {"nn_cookie_ids":[],"cookielist":[],"non_necessary_cookies":[],"ccpaEnabled":"","ccpaRegionBased":"","ccpaBarEnabled":"","strictlyEnabled":["necessary","obligatoire"],"ccpaType":"gdpr","js_blocking":"","custom_integration":"","triggerDomRefresh":"","secure_cookies":""};
var cli_cookiebar_settings = {"animate_speed_hide":"500","animate_speed_show":"500","background":"#384353","border":"#b1a6a6c2","border_on":"","button_1_button_colour":"#384353","button_1_button_hover":"#2d3642","button_1_link_colour":"#fff","button_1_as_button":"","button_1_new_win":"","button_2_button_colour":"#333","button_2_button_hover":"#292929","button_2_link_colour":"#00a5bf","button_2_as_button":"","button_2_hidebar":"1","button_3_button_colour":"#000","button_3_button_hover":"#000000","button_3_link_colour":"#fff","button_3_as_button":"1","button_3_new_win":"","button_4_button_colour":"#000","button_4_button_hover":"#000000","button_4_link_colour":"#fff","button_4_as_button":"1","button_7_button_colour":"#61a229","button_7_button_hover":"#4e8221","button_7_link_colour":"#fff","button_7_as_button":"1","button_7_new_win":"","font_family":"inherit","header_fix":"","notify_animate_hide":"1","notify_animate_show":"","notify_div_id":"#cookie-law-info-bar","notify_position_horizontal":"right","notify_position_vertical":"bottom","scroll_close":"","scroll_close_reload":"","accept_close_reload":"","reject_close_reload":"","showagain_tab":"1","showagain_background":"#fff","showagain_border":"#000","showagain_div_id":"#cookie-law-info-again","showagain_x_position":"100px","text":"#b7b7b7","show_once_yn":"","show_once":"10000","logging_on":"","as_popup":"","popup_overlay":"1","bar_heading_text":"","cookie_bar_as":"banner","popup_showagain_position":"bottom-right","widget_position":"left"};
var log_object = {"ajax_url":"\/wp\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" src="../../../../wp/wp-content/plugins/cookie-law-info/public/js/cookie-law-info-public.js?ver=2.0.3" id="cookie-law-info-js"></script>
<script type="text/javascript" src="../../../../wp/wp-content/plugins/testimonial-rotator/js/jquery.cycletwo.js?v=1.101.1" id="cycletwo-js"></script>
<script type="text/javascript" src="../../../../wp/wp-content/plugins/testimonial-rotator/js/jquery.cycletwo.addons.js?v=1.101.1" id="cycletwo-addons-js"></script>
<script type="text/javascript" src="../../../../wp/wp-content/plugins/easy-logo-slider/js/jquery.jcarousel.min.js?v=1.101.1" id="jquery_jcarousel_min-js"></script>
<script type="text/javascript" src="../../../../wp/wp-content/plugins/easy-logo-slider/js/jcarousel.responsive.js?ver=09e48cfb58fec140b4ee0c6d1d4da1b2" id="jcarousel_responsive-js"></script>
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json../../../../wp/v2/posts/1956">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../wp/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../wp/wp-includes/wlwmanifest.xml"> 

<link rel="shortlink" href="/?p=1956">
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2F2014%2F11%2F25%2Fstackstorm-automated-troubleshooting%2F">
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2F2014%2F11%2F25%2Fstackstorm-automated-troubleshooting%2F&#038;format=xml">
<style type="text/css">:not(#tve) .ttfm1{font-family: 'dual300' !important;font-weight: 400 !important;}.ttfm1 input, .ttfm1 select, .ttfm1 textarea, .ttfm1 button {font-family: 'dual300' !important;font-weight: 400 !important;}:not(#tve) .ttfm2{font-family: 'Roboto' !important;font-weight: 400 !important;}.ttfm2 input, .ttfm2 select, .ttfm2 textarea, .ttfm2 button {font-family: 'Roboto' !important;font-weight: 400 !important;}:not(#tve) .ttfm2.bold_text,.ttfm2 .bold_text,.ttfm2 b,.ttfm2 strong{font-weight: 500 !important;}.ttfm2.bold_text,.ttfm2 .bold_text,.ttfm2 b,.ttfm2 strong input, .ttfm2.bold_text,.ttfm2 .bold_text,.ttfm2 b,.ttfm2 strong select, .ttfm2.bold_text,.ttfm2 .bold_text,.ttfm2 b,.ttfm2 strong textarea, .ttfm2.bold_text,.ttfm2 .bold_text,.ttfm2 b,.ttfm2 strong button {font-weight: 500 !important;}</style>
<style type="text/css" id="tve_global_variables">:root{--tcb-gradient-0:linear-gradient(180deg, #ff712c 0%, #000000 100%);}</style>		<style type="text/css">.wp-video-shortcode {
				max-width: 100% !important;
			}

			.bSe a {
				clear: right;
			}

			.bSe blockquote {
				clear: both;
			}
			body { background:#FFF; }.cnt article h1.entry-title a { color:#333; }.cnt article h2.entry-title a { color:#333; }.bSe h1, h1.entry-title, h1.entry-title a { color:#333; }.bSe h2 { color:#464545; }.bSe h3 { color:#333; }.bSe h4 { color:#333; }.bSe h5 { color:#333; }.bSe h6 { color:#333; }.bSe p, .mry .awr-e p { color:#666; }.cnt .bSe { color:#666; }.cnt h1 a, .tve-woocommerce .bSe .awr .entry-title, .tve-woocommerce .bSe .awr .page-title{font-family:Roboto,sans-serif;}.bSe h1{font-family:Roboto,sans-serif;}.bSe h2,.tve-woocommerce .bSe h2{font-family:Roboto,sans-serif;}.bSe h3,.tve-woocommerce .bSe h3{font-family:Roboto,sans-serif;}.bSe h4{font-family:Roboto,sans-serif;}.bSe h5{font-family:Roboto,sans-serif;}.bSe h6{font-family:Roboto,sans-serif;}#text_logo{font-family:Roboto,sans-serif;}.cnt h1 a { font-weight:500; }.bSe h1 { font-weight:500; }.bSe h2 { font-weight:500; }.bSe h3 { font-weight:500; }.bSe h4 { font-weight:500; }.bSe h5 { font-weight:500; }.bSe h6 { font-weight:500; }.cnt{font-family:Roboto,sans-serif;font-weight:300;}article strong {font-weight: bold;}.cnt p, .tve-woocommerce .product p, .tve-woocommerce .products p, .brd ul li, header nav ul li a, header nav ul li > ul li a, .has-extended.has-heading .colch, footer, footer .fmm p, .aut-f{font-family:Roboto,sans-serif;font-weight:300;}article strong {font-weight: bold;}.bSe h1, .bSe .entry-title { font-size:46px; }.cnt { font-size:18px; }.thrivecb { font-size:18px; }.out { font-size:18px; }.aut p { font-size:18px; }.cnt p { line-height:1.5em; }.thrivecb { line-height:1.5em; }.bSe a, .cnt a { color:#24447b; }.bSe .faq h4{font-family:Roboto,sans-serif;font-weight:300;}article strong {font-weight: bold;}header nav > ul.menu > li > a { color:#fff; }header nav > ul.menu > li >  a:hover { color:#fff; }header nav > ul > li.current_page_item > a:hover { color:#fff; }header nav > ul > li.current_menu_item > a:hover { color:#fff; }header nav > ul > li.current_menu_item > a:hover { color:#fff; }header nav > ul > li > a:active { color:#fff; }header #logo > a > img { max-width:200px; }header ul.menu > li.h-cta > a { color:#FFFFFF!important; }header ul.menu > li.h-cta > a { background:#4b7cc7; }header ul.menu > li.h-cta > a { border-color:#4b7cc7; }header ul.menu > li.h-cta > a:hover { color:#4b7cc7!important; }header ul.menu > li.h-cta > a:hover { background:#transparent; }</style>
		<style type="text/css">span.oe_textdirection { unicode-bidi: bidi-override; direction: rtl; }
	span.oe_displaynone { display: none; }</style>
<style type="text/css" id="thrive-default-styles">@media (min-width: 300px) { .tcb-style-wrap blockquote {color:rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);font-family:Roboto, sans-serif;font-size:18px;font-weight:300;font-style:normal;margin:;padding-top:0px;padding-bottom:0px;text-decoration:rgb(102, 102, 102);text-transform:none;border-left:;--tcb-applied-color:;} }</style>
<link rel="icon" href="../../../../wp/wp-content/uploads/2015/09/st2.png" sizes="32x32">
<link rel="icon" href="../../../../wp/wp-content/uploads/2015/09/st2.png" sizes="192x192">
<link rel="apple-touch-icon" href="../../../../wp/wp-content/uploads/2015/09/st2.png">
<meta name="msapplication-TileImage" content="../../../../wp/wp-content/uploads/2015/09/st2.png">
		<style type="text/css" id="wp-custom-css">/*
You can add your own CSS here.

Click the help icon above to learn more.
*/

.bSe ul:not([class]) {
margin-left: 20px;
margin-bottom: 15px;
}

.bSe ul:not([class]) li {
    padding-left: 0;
    margin-bottom: 5px;
    position: relative;
}

/* StackStorm "Donate" button */
li#menu-item-9062 a {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    background-color: #418cc5;
    border: 3px solid #418cc5;
    color: #fff !important;
    text-decoration: none;
    height: 30px;
    border-radius: 20px;
    padding: 0 12px;
    font-weight: 400;
    transition: all .25s ease-in-out;
}
li#menu-item-9062 a:hover {
    color: #333 !important;
}
li#menu-item-9062 a:before {
    top: 0;
}</style>
					<style type="text/css">/* ***blog*** */

pre code {
        overflow: scroll !important;
	white-space: pre !important;
	font-size: 11px
}

header.side nav>ul>li {
    padding: 15px !important;
}

.cnt {
    margin-top: 50px !important;
}

.cnt a.customHref{
    color: #f82 !important;
}

.bSe ul li:before {
    content: '' !important;
    position: absolute;
    left: 0;
    top: -2px;
}

.bSe ul {
    list-style-type: disc !important;
}

.bSe table tbody tr{
    border-top-width:0px !important;
}

code {
    font-size: 0.9em !important;
}

pre{
    font-family: Monaco, MonacoRegular, monospace !important;
    font-size: 14px !important;
    background-color: rgb(250,253,255) !important;
    padding: 0px 3px 0px 3px !important;
    white-space: pre !important;
}

.bSe h1, .bSe .entry-title {
    line-height: 1.2;
    font-size: 40px;
}

.bSe h2 {
    font-weight: 300;
}

.bSe h2, .tve-woocommerce .bSe h2 {
    font-family: "Roboto",sans-serif;
}

.cnt p, .tve-woocommerce .product p, .tve-woocommerce .products p {
    font-family: Roboto,sans-serif;
    font-weight: 300;
}

p {
    margin-bottom: 15px;
}


header.fbh {
    height: 49px;
}
header #logo>a>img {
    max-width: 150px;
}

.gist .blob-code .blob-code-inner .js-file-line  {
    white-space: pre !important;
}</style>
		
</head>
<body class="post-template-default single single-post postid-1956 single-format-standard">


<!-- BEGIN LF Header --> 	<div id="lf-header" style="padding-bottom: 3px; padding-top: 3px;background: #252525;"> 		<div class="container wrp"> 			<a href="https://linuxfoundation.org/projects" target="_blank" rel="noopener noreferrer"> 				<img src="../../../../wp/wp-content/themes/stackstorm/images/logo_lf_projects_horizontal.png" style="max-width: 270px;"> 			</a> 		</div> 	</div> 	<!-- END LF Header -->

<div class="theme-wrapper">
	
	
	
	
	<div class="fln">
		<div class="wrp clearfix">
												<a class="fl-l" href="../../../../index.html">
						<img src="../../../../wp/wp-content/uploads/2016/10/StackStorm-logo228.png" alt="StackStorm">
					</a>
										<div class="fl-s clearfix">
																<ul>
																													</ul>
			</div>
		</div>
	</div>


	<div class="header-wrapper h-bi">
		<div id="floating_menu" data-float="float" data-social="0">
			<header class="side" style="">
								<div class="h-i">
					<div class="wrp">
														<div id="logo">
									<a href="../../../../index.html">
										<img src="../../../../wp/wp-content/uploads/2016/10/StackStorm-logo228.png" alt="StackStorm"></a>
								</div>
																					<div class="m-s">
								<div class="hsm"></div>
								<div class="m-si">
																												<nav class="menu-stackstorm-refresh-container"><ul id="menu-stackstorm-refresh" class="menu">
<li id="menu-item-5952" class="menu-item menu-item-type-custom menu-item-object-custom toplvl"><a href="../../../../features/index.html">Features</a></li>
<li id="menu-item-6100" class="menu-item menu-item-type-custom menu-item-object-custom toplvl"><a href="../../../../index.html#community">Community</a></li>
<li id="menu-item-4207" class="menu-item menu-item-type-custom menu-item-object-custom toplvl"><a target="_blank" href="http://docs.stackstorm.com/">Docs</a></li>
<li id="menu-item-8701" class="menu-item menu-item-type-custom menu-item-object-custom toplvl"><a href="https://exchange.stackstorm.org/">Exchange</a></li>
<li id="menu-item-2277" class="menu-item menu-item-type-custom menu-item-object-custom toplvl"><a href="../../../../blog/index.html">Blog</a></li>
<li id="menu-item-9062" class="menu-item menu-item-type-post_type menu-item-object-page toplvl"><a href="../../../../donate/index.html">Donate</a></li>
</ul></nav>										<!-- Cart Dropdown -->
									
																	</div>
							</div>
						
					</div>
				</div>

			</header>
		</div>
	</div>

	
	
	
	
			
		
		<div class="wrp cnt">


			<section class="bSe bpd">
				
<div class="awr">

	
	
	
				<h1 class="entry-title">StackStorm &#8211; Automated Troubleshooting</h1>
		
	
	
		<div class="awr-i">
		<p><strong>November 24, 2014</strong></p>
<p><em>by Patrick Hoolboom</em></p>
<p>I’ve done a couple articles about getting StackStorm set up, an introductory video, and put a fair amount of effort towards minimizing the barrier to entry for new users.  Overall, I think StackStorm was successful in providing a quick and easy way to get our system up and running but users need more than that.  Users need to see how StackStorm can help solve their specific pain points.  We needed a way to illustrate that we can provide an easy to use solution without the steep learning curve of throwing out your existing tools.  Over a series of a few blog posts we are going to go over some of the ways that we have leveraged the StackStorm platform internally and how these solutions could map to your environment.</p>
<p><span id="more-1956"></span></p>
<p><b>Facilitated Troubleshooting</b></p>
<p>What I’d like to walk through today is a use case we refer to as Facilitated Troubleshooting.  It leverages the power of the StackStorm automation platform to provide rich context around operational incidents in a collaborative fashion.  It gives the users the info they need in an urgent situation faster, in order to help minimize time to resolution.</p>
<p><b>Integrating with your Monitoring</b></p>
<p>For this particular write up I’ll be using Sensu as my monitoring system of choice.  I’ll also be using the StackStorm CLI from StackStorm 0.5.2; the StackStorm GUI is not yet widely available.  When it is available the GUI will simplify the usage of StackStorm.</p>
<p>It is important to note that integrating any system that has the ability to emit events/notifications should be fairly similar to this Sensu example.  To get started you need to install the sensu and linux packs on your StackStorm installation.</p>
<p><code>st2 pack install sensu</code></p>
<p>Once those packs are installed, you can see the actions in your action library:</p>
<pre><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="790911161615390a0d4b14180a0d1c0b494948">[email&#160;protected]</a>:~$ st2 action list --pack=sensu
+-------------------------------+-------+-------------------------+--------------------------------+
| ref                           | pack  | name                    | description                    |
+-------------------------------+-------+-------------------------+--------------------------------+
| sensu.aggregate_list          | sensu | aggregate_list          | List Sensu Aggregate Stats     |
| sensu.check_aggregates        | sensu | check_aggregates        | Get Sensu check aggregates     |
| sensu.check_aggregates_delete | sensu | check_aggregates_delete | Delete Sensu check aggregates  |
| sensu.check_aggregates_issued | sensu | check_aggregates_issued | Get a specific Sensu check     |
|                               |       |                         | aggregate                      |
| sensu.check_info              | sensu | check_info              | Get Sensu check info           |
| sensu.check_list              | sensu | check_list              | List Sensu checks              |
| sensu.check_request           | sensu | check_request           | Schedule a Sensu check request |
| sensu.client_delete           | sensu | client_delete           | Delete a Sensu client          |
| sensu.client_history          | sensu | client_history          | Get Sensu client history       |
| sensu.client_info             | sensu | client_info             | Get Sensu client info          |
| sensu.client_list             | sensu | client_list             | List Sensu clients             |
| sensu.event_client_list       | sensu | event_client_list       | List Sensu events for a given  |
|                               |       |                         | client                         |
| sensu.event_delete            | sensu | event_delete            | Delete a Sensu event           |
| sensu.event_info              | sensu | event_info              | Get Sensu event info           |
| sensu.event_list              | sensu | event_list              | List Sensu events              |
| sensu.health                  | sensu | health                  | Sensu System Health            |
| sensu.info                    | sensu | info                    | Sensu System Info              |
+-------------------------------+-------+-------------------------+--------------------------------+
</pre>
<p>Now you will need to put the event handler on your Sensu server.</p>
<p><code>curl -o /etc/sensu/handlers/st2_handler.py</code></p>
<p><a href="https://raw.githubusercontent.com/StackStorm-Exchange/stackstorm-sensu/master/etc/st2_handler.py">[LINK]</a></p>
<p><code>sudo chmod +x /etc/sensu/handlers/st2_handler.py</code></p>
<p>I add the st2_handler as the default handler on my Sensu server.  This way I get all monitoring events in my environment sent to my control plane (StackStorm) to provide the best possible context for my automation.  Here is an example config file</p>
<pre style="font-size: 12px;"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1a6875756e5a697f74696f2a2a2b">[email&#160;protected]</a>:/home/phool# cat /etc/sensu/conf.d/handler.json 
{
    "handlers": {
        "default": {
          "type": "pipe",
          "command": "python /etc/sensu/handlers/st2_handler.py"
        }
    }
}
</pre>
<p>You can also get that handler.json file via curl with the following command:</p>
<p><code>curl -o /etc/sensu/conf.d/handler.json</code></p>
<p><a href="https://gist.githubusercontent.com/DoriftoShoes/3b918981d287281936fb/raw/6c5135db3d71dc2b717aaa7c3bb0144bd77200d4/handler.json">[LINK]</a></p>
<p>The handler needs a small change made in order to point it to your StackStorm instance.  Open up the file in your favorite text editor and change line 13 to the ip address of where StackStorm is running:</p>
<p>ST2_HOST = &#8216;1.2.3.4&#8217;</p>
<p>Now that you have the event handler installed and configured you can test it.  This curl command grabs a gist of some dummy data and fires the event handler with it.</p>
<p>curl -Ss <a href="https://gist.githubusercontent.com/DoriftoShoes/5ffe364eed55e52eca3c/raw/7e776e9c2f8f26b814e9aaaf4abfbdddf390202e/event_data.json | /etc/sensu/handlers/st2_handler.py">[LINK]</a></p>
<p>You should see “Sent sensu event to st2. HTTP_CODE: 202”.  This means the event was successfully sent to the StackStorm server.  If we hop on over to the StackStorm server, we can see that the new trigger type got registered in the system:</p>
<pre style="font-size: 12px;"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="8afae2e5e5e6caf9feb8e7ebf9feeff8bababb">[email&#160;protected]</a>:~$ st2 trigger list
+--------------------------------+-------+---------------------------+--------------------------------+
| ref                            | pack  | name                      | description                    |
+--------------------------------+-------+---------------------------+--------------------------------+
| core.st2.generic.actiontrigger | core  | st2.generic.actiontrigger | Trigger encapsulating the      |
|                                |       |                           | completion of an action        |
|                                |       |                           | execution.                     |
| core.st2.webhook               | core  | st2.webhook               | Relays a Trigger POSTed to the |
|                                |       |                           | supplied URL. The supplied url |
|                                |       |                           | is used as a suffix of http:// |
|                                |       |                           | :6001/webhooks/gener |
|                                |       |                           | ic/..                          |
| core.st2.IntervalTimer         | core  | st2.IntervalTimer         | Triggers on specified          |
|                                |       |                           | intervals. e.g. every 30s,     |
|                                |       |                           | 1week etc.                     |
| core.st2.DateTimer             | core  | st2.DateTimer             | Triggers exactly once when the |
|                                |       |                           | current time matches the       |
|                                |       |                           | specified time. e.g.           |
|                                |       |                           | timezone:UTC date:2014-12-31   |
|                                |       |                           | 23:59:59.                      |
| core.st2.CronTimer             | core  | st2.CronTimer             | Triggers whenever current time |
|                                |       |                           | matches the specified time     |
|                                |       |                           | constaints like a UNIX cron    |
|                                |       |                           | scheduler.                     |
| aws.instance_status            | aws   | instance_status           | EC2 Instance Status Sensor     |
| aws.volume_status              | aws   | volume_status             | EC2 Volume Status Sensor       |
| jira.issues_tracker            | jira  | issues_tracker            | JIRA issues tracker            |
| git.head_sha_monitor           | git   | head_sha_monitor          | Stackstorm git commits tracker |
| sensu.event_handler            | sensu | event_handler             | Trigger type for sensu event   |
|                                |       |                           | handler.                       |
+--------------------------------+-------+---------------------------+--------------------------------+
</pre>
<p>And if we check the st2reactor.log file we will see a line like this:</p>
<p>Nov 24 00:52:11 st2server.lab.fake.net st2reactor[3742]: INFO 140457524810288 engine [-] Found 0 rules defined for trigger event_handler</p>
<p>Now we have the sensu actions installed in the action library, and we have our Sensu server creating StackStorm triggers on monitoring events, let’s wire these together with some rules.  Here is a basic rule that takes all Sensu events that come in to the system and sends an email with the payload of data for the event:</p>
<pre style="font-size: 12px;">---
  name: "sensu.event_to_email"
  description: "Email all sensu events"
  trigger: 
    type: "sensu.event_handler"
    parameters: {}
  criteria: {}
  action: 
    ref: "core.sendmail"
    parameters: 
      to: "<span class="oe_textdirection">&#x6d;&#x6f;&#x63;&#x2e;&#x6c;&#x69;&#x61;&#x6d;&#x65;<span class="oe_displaynone">null</span>&#x40;&#x65;&#x6b;&#x61;&#x66;</span>"
      subject: "'[SENSU] {{trigger.client.name}} - {{trigger.check.name}}'"
      body: "{{trigger}}"
  enabled: true
</pre>
<p>If you’d like you can pull this down from the follow URL:</p>
<p><a href="https://gist.githubusercontent.com/DoriftoShoes/8d67be4cfe64b93ed2ed/raw/a332ff0b6a68e902309a72d4d52f30cc3364e0c8/sensu_event_to_email.yaml">[LINK]</a></p>
<p>This event illustrates how the rules engine works at its most basic level but it isn’t a very useful rule.  What we’ll do is actually create a workflow that will do some basic diagnostic work when a monitoring event comes in.  For this workflow we are going to use a high cpu load alert.  I have the check_load script from the Sensu community repo running on all my servers so I’ll be basing the rule and workflow around that alert.</p>
<p><b>Writing Your Workflow</b></p>
<p>First let’s build a workflow for troubleshooting.  I started by thinking, if I got paged about high load, what would be the first things I would do/want to know about?  I came up with the following low hanging fruit:</p>
<ul>
<li>Up to date load numbers (verify the alert)</li>
<li>Any processes that are currently running (R state)</li>
<li>Any processes in uninterruptible sleep (D state)</li>
<li>Any network connections from the above processes</li>
<li>Any files opened by the above processes</li>
</ul>
<p>One important thing to note here is that this data needs to be returned in some sort of collaborative way to not only provide this context to me but also to anyone else that may be working on the issue.  Since we heavily use ChatOps here at StackStorm and support chat integrations via what we call “storm bot”, I have chosen to use the core.stormbot_say action to post this data into our chat room.  Your actual collaboration environment may be different so you may choose to post this to a ticketing system or even email.</p>
<p>The tasks I asked StackStorm to perform are fairly basic but it is a lot easier if the system does them for me.  Now, there are actions in the ‘linux’ StackStorm pack from the community repo that will do all of these things.  It is just a matter of writing a workflow to stitch them together.</p>
<p>I have already written this particular diagnostic workflow, and it is included in the ‘linux’ pack, but I would like to go over the process of constructing it here.</p>
<p>I used the built in workflow engine “action-chain” for this since it is a simple linear workflow with very little conditional logic.  For more complex workflows you’ll use our Mistral based workflow.</p>
<p>The first thing I did is write the “chain” file, that defines all of the actions in the chain and their links (on-success or on-failure).  Here is the chain file:</p>
<pre style="font-size: 12px;">---
  chain: 
    - 
      name: "check_load"
      ref: "linux.check_loadavg"
      params: 
        hosts: "{{hostname}}"
        period: "all"
      on-success: "d_state_processes"
      on-failure: "email_escalation"
    - 
      name: "d_state_processes"
      ref: "linux.check_processes"
      params: 
        hosts: "{{hostname}}"
        search: "state"
        criteria: "D"
        args: "pidlist"
      on-success: "r_state_processes"
      on-failure: "email_escalation"
    - 
      name: "r_state_processes"
      ref: "linux.check_processes"
      params: 
        hosts: "{{hostname}}"
        search: "state"
        criteria: "R"
        args: "pidlist"
      on-success: "netstat"
      on-failure: "email_escalation"
    - 
      name: "netstat"
      ref: "linux.netstat_grep"
      params: 
        hosts: "{{hostname}}"
        pids: "{{d_state_processes[hostname].stderr}} {{r_state_processes[hostname].stderr}}"
      on-success: "lsof"
      on-failure: "email_escalation"
    - 
      name: "lsof"
      ref: "linux.lsof_pids"
      params: 
        hosts: "{{hostname}}"
        pids: "{{d_state_processes[hostname].stderr}} {{r_state_processes[hostname].stderr}}"
      on-success: "to_file"
      on-failure: "email_escalation"
    - 
      name: "stormbot_say"
      ref: "core.stormbot_say"
      params: 
        source: "ACTION"
        name: "load_alert_diagnostics"
        msg: "'\nLOAD: {{check_load[hostname].stdout}}\nState D: {{d_state_processes[hostname].stdout}}\nState R:{{r_state_processes[hostname].stdout}}'"
      on-failure: "email_escalation"
    - 
      name: "email_escalation"
      ref: "core.local"
      params: 
        cmd: "echo 'ST2 Workflow Failure\tThe load_alert workflow has failed\t{{__results}}' &gt;&gt; /tmp/chain &amp;&amp; echo 'Output written to file'"
    - 
      name: "to_file"
      ref: "core.local"
      params: 
        cmd: "echo 'ST2 Workflow Results\n\tThe load_alert workflow results:\n\n{{__results}}' &gt;&gt; /tmp/chain &amp;&amp; echo 'Output written to file'"
  default: "check_load"
</pre>
<p>This workflow simply walks through the items we addressed in the bullet points above, collects the appropriate data, and then spits it out into chat via the integrated chatops action.  Once again, you could have it spit the information out into a ticketing system or even email if you wanted.</p>
<p>Most of this is fairly self explanatory.</p>
<ul>
<li>‘name’ is an arbitrary name given to that action simply for identification purposes within the context of the action-chain.</li>
<li>‘ref’ is our standard reference to an action (&lt;PACK_NAME&gt;.&lt;ACTION_NAME&gt;)</li>
<li>‘params’ are the parameters for that action.</li>
<li>‘on-success’ tells the chain which action (by NAME) to do on successful completion of the step</li>
<li>‘on-failure’ on the other hand tells the chain which action to do if it fails.</li>
</ul>
<p>The chain will continue until it completes an action that does not have the next step defined.</p>
<p>The action-chain is treated as any other action in the system.  So the action-chain requires a meta-data file in order to be registered in the action library.  We simply write the meta data defining action-chain as the runner_type, point the entry point at the chain file, and fill in any parameters.  For this particular workflow the metadata file looks like this:</p>
<pre style="font-size: 12px;">---
  name: "diag_loadavg"
  description: "Diagnostic workflow for high load alert"
  runner_type: "action-chain"
  enabled: true
  entry_point: "diag_loadavg.chain.yaml"
  parameters: 
    hostname: 
      type: "string"
      description: "Hostname of the server to perform load_alert diagnostics on"
</pre>
<p>If you installed the ‘linux’ pack earlier all of this should already be loaded in your system.  Now let’s write a rule to tie this into a cpu load monitoring event.</p>
<p><b>Tying it all Together with a Rule</b></p>
<p>We have our incoming events now, and we have our diagnostic workflow defined in the action library.  Next we need to create a rule that will fire the diagnostic workflow on the appropriate Sensu event.  Here is a basic rule to fire the workflow on a Sensu event:</p>
<pre style="font-size: 12px;">---
  name: "sensu.loadavg_diag"
  description: "Run diagnostic checks when receiving a high load alert"
  trigger: 
    type: "sensu.event_handler"
    parameters: {}
  criteria: {}
  action: 
    ref: "linux.diag_loadavg"
    parameters: 
      hostname: "{{trigger.client.name}}"
  enabled: true
</pre>
<p>We have got the correct trigger mapped to the action (linux.diag_loadavg) and we are using the client name from the trigger payload as the hostname (we can see in the parameters for the action that we have the namespaced template variable there trigger.client.name).  All inputs to the trigger are namespaced under the name ‘trigger’.  Since Sensu sends in JSON, it gets parsed all the way down and we have access to those keys.  In this case we are using the name field from the client section of the payload as the hostname.</p>
<p>The problem with this rule is that it will fire on <em>every</em> Sensu event&#8230;regardless of whether it is load related or not.  We need to leverage the criteria field to narrow it down.  To determine what data is available to us, we refer to the Sensu docs to see what is given in the event payload:</p>
<p><a href="http://sensuapp.org/docs/0.16/event_data">http://sensuapp.org/docs/0.16/event_data</a></p>
<p>Let’s go ahead and filter on the name of the check and the output.</p>
<pre style="font-size: 12px;">---
  name: "sensu.loadavg_diag"
  description: "Run diagnostic checks when receiving a high load alert"
  trigger: 
    type: "sensu.event_handler"
    parameters: {}
  criteria: 
    trigger.check.name: 
      pattern: "check_load"
      type: "equals"
    trigger.check.output: 
      pattern: ".*CRITICAL.*"
      type: "matchregex"
  action: 
    ref: "linux.diag_loadavg"
    parameters: 
      hostname: "{{trigger.client.name}}"
  enabled: true
</pre>
<p>You can see that we have added trigger.check.name and trigger.check.output as fields to be used in the criteria section.  For these fields we need to specify the type of operator that will be used and the pattern to try and match against.  The currently supported operator types are:</p>
<ul>
<li>matchregex</li>
<li>equals</li>
<li>lt or lessthan</li>
<li>gt or greaterthan</li>
<li>td_lt or timediff_lt</li>
<li>td_gt or timediff_gt</li>
</ul>
<p>I have chosen to to use matchregex to look for CRITICAL in the output and to make sure the name equals “check_load”.  This is a fairly good rule but it could be flappy.  We may not want to fire the diagnostic workflow until the 3rd or more failure to avoid false positives.  The other addition that I like to have is to only run it on the creation of the event.  We generally don’t need the diagnostic work done on an event resolution.  Here is my final version of the rule:</p>
<pre style="font-size: 12px;">---
  name: "sensu.loadavg_diag"
  description: "Run diagnostic checks when receiving a high load alert"
  trigger: 
    type: "sensu.event_handler"
    parameters: {}
  criteria: 
    trigger.check.name: 
      pattern: "check_load"
      type: "equals"
    trigger.check.output: 
      pattern: ".*CRITICAL.*"
      type: "matchregex"
    trigger.occurrences: 
      pattern: 2
      type: "gt"
    trigger.action: 
      pattern: "create"
      type: "matchregex"
  action: 
    ref: "linux.diag_loadavg"
    parameters: 
      hostname: "{{trigger.client.name}}"
  enabled: true
</pre>
<p>You can save this rule in the rules folder of the sensu pack (the default location would be /opt/stackstorm/sensu/rules). Once you have the rule saved on disk, use the st2 client to register it:</p>
<p>st2 rule create NEW_RULE_FILENAME.yaml</p>
<p>Now check the rule list and see if it appears:</p>
<pre style="font-size: 12px;">st2 rule list
+--------------------------+-------------------------+------------------------------------------+
| id                       | name                    | description                              |
+--------------------------+-------------------------+------------------------------------------+
| 546b03e6e7fccd108adb533c | st2_ubuntu_python_tests | Run python tests on Ubuntu for each      |
|                          |                         | commit to master of st2                  |
| 546bbfa8e7fccd430c6d67df | st2_health_check        | Touches a file on a 5 minute interval    |
| 5472df9cd217540e9d2278ef | sensu.loadavg_diag      | Run diagnostic checks when receiving a   |
|                          |                         | high load alert                          |
+--------------------------+-------------------------+------------------------------------------+
</pre>
<p>There it is!  ‘sensu.loadavg_diag’ is our new rule.  In order to test the full rule you would need to add some load to one of your monitored servers, but we can easily run the workflow by hand and see if it completes.</p>
<pre style="font-size: 12px;">st2 run linux.diag_loadavg hostname=localhost -a
+-----------------+-----------------------------+
| Property        | Value                       |
+-----------------+-----------------------------+
| id              | 5472ff14d217540e9d227939    |
| context         | {                           |
|                 |     "user": "stanley"       |
|                 | }                           |
| parameters      | {                           |
|                 |     "hostname": "localhost" |
|                 | }                           |
| status          | scheduled                   |
| start_timestamp | 2014-11-24T09:49:08.723713Z |
| result          |                             |
| action          | linux.diag_loadavg          |
| callback        |                             |
+-----------------+-----------------------------+
To get the results, execute: 
    $ st2 execution get 5472ff14d217540e9d227939
</pre>
<p>Now we can check the execution list and we’ll see the workflow going through the actions we defined earlier.</p>
<pre style="font-size: 12px;">st2 execution list -n 7
+--------------------------+-----------------------+--------------+-----------+-----------------------------+
| id                       | action                | context.user | status    | start_timestamp             |
+--------------------------+-----------------------+--------------+-----------+-----------------------------+
| 5472ff14d217540e9d227939 | linux.diag_loadavg    | stanley      | succeeded | 2014-11-24T09:49:08.723000Z |
| 5472ff14d217540e96362189 | linux.check_loadavg   | stanley      | succeeded | 2014-11-24T09:49:08.819000Z |
| 5472ff16d217540e9636218a | linux.check_processes | stanley      | succeeded | 2014-11-24T09:49:10.874000Z |
| 5472ff18d217540e9636218b | linux.check_processes | stanley      | succeeded | 2014-11-24T09:49:12.907000Z |
| 5472ff1ad217540e9636218c | linux.netstat_grep    | stanley      | succeeded | 2014-11-24T09:49:14.944000Z |
| 5472ff1bd217540e9636218d | linux.lsof_pids       | stanley      | succeeded | 2014-11-24T09:49:15.989000Z |
| 5472ff1dd217540e9636218e | core.stormbot_say     | stanley      | succeeded | 2014-11-24T09:49:17.012000Z |
+--------------------------+-----------------------+--------------+-----------+-----------------------------+
</pre>
<p>If we get the execution results of the workflow (linux.diag_loadavg) we can see the output from all of the actions.</p>
<pre style="font-size: 12px;">st2 execution get 5472ff14d217540e9d227939
+-----------------+---------------------------------------------------------+
| Property        | Value                                                   |
+-----------------+---------------------------------------------------------+
| id              | 5472ff14d217540e9d227939                                |
| action          | linux.diag_loadavg                                      |
| callback        |                                                         |
| context         | {                                                       |
|                 |     "user": "stanley"                                   |
|                 | }                                                       |
| parameters      | {                                                       |
|                 |     "hostname": "localhost"                             |
|                 | }                                                       |
| result          | {                                                       |
|                 |     "stormbot_say": {                                   |
|                 |         "localhost": {                                  |
|                 |             "failed": false,                            |
|                 |             "stderr": "",                               |
|                 |             "return_code": 0,                           |
|                 |             "succeeded": true,                          |
|                 |             "stdout": "Message posted successfully"     |
|                 |         }                                               |
|                 |     },                                                  |
|                 |     "d_state_processes": {                              |
|                 |         "localhost": {                                  |
|                 |             "failed": false,                            |
|                 |             "stderr": "",                               |
|                 |             "return_code": 0,                           |
|                 |             "succeeded": true,                          |
|                 |             "stdout": "{}"                              |
|                 |         }                                               |
|                 |     },                                                  |
|                 |     "netstat": {                                        |
|                 |         "localhost": {                                  |
|                 |             "failed": false,                            |
|                 |             "stderr": "",                               |
|                 |             "return_code": 0,                           |
|                 |             "succeeded": true,                          |
|                 |             "stdout": ""                                |
|                 |         }                                               |
|                 |     },                                                  |
|                 |     "check_load": {                                     |
|                 |         "localhost": {                                  |
|                 |             "failed": false,                            |
|                 |             "stderr": "",                               |
|                 |             "return_code": 0,                           |
|                 |             "succeeded": true,                          |
|                 |             "stdout": "{\"1\": \"0.055\", \"15\":       |
|                 | \"0.095\", \"5\": \"0.09\"}"                            |
|                 |         }                                               |
|                 |     },                                                  |
|                 |     "r_state_processes": {                              |
|                 |         "localhost": {                                  |
|                 |             "failed": false,                            |
|                 |             "stderr": "",                               |
|                 |             "return_code": 0,                           |
|                 |             "succeeded": true,                          |
|                 |             "stdout": "{}"                              |
|                 |         }                                               |
|                 |     },                                                  |
|                 |     "lsof": {                                           |
|                 |         "localhost": {                                  |
|                 |             "failed": false,                            |
|                 |             "stderr": "",                               |
|                 |             "return_code": 0,                           |
|                 |             "succeeded": true,                          |
|                 |             "stdout": ""                                |
|                 |         }                                               |
|                 |     }                                                   |
|                 | }                                                       |
| start_timestamp | 2014-11-24T09:49:08.723000Z                             |
| status          | succeeded                                               |
+-----------------+---------------------------------------------------------+
</pre>
<p>Since this particular server wasn’t experiencing high load, the output isn’t all that interesting.  When this rule/workflow combination gets really interesting is during a high load event.  I went ahead and wrote a script to simulate load on one of my servers to test out the rule and workflow.  Sure enough, Sensu sent in the trigger via the handler and it started the diagnostic workflow.  The workflow collected all of the data and then posted it to a chat room on Slack as you can see below:<br>
<img loading="lazy" class="alignnone wp-image-1975 size-full" src="../../../../wp/wp-content/uploads/2014/11/Image-from-chat2.jpg" alt="Image from chat" width="629" height="561" srcset="../../../../wp/wp-content/uploads/2014/11/Image-from-chat2.jpg 629w, ../../../../wp/wp-content/uploads/2014/11/Image-from-chat2-300x267.jpg 300w" sizes="(max-width: 629px) 100vw, 629px"></p>
<p>This particular workflow doesn’t do a lot of manipulation of the data through either filtering or formatting.  The main purpose of it is to get a full context of what is causing the load on the machine.  There are a number of ways to “prettify” this data going forward as we improve upon this workflow.</p>
<p>I truncated a fair amount of the lsof output as it was quite large, but you can see that the context that was I was looking for when I wrote the workflow is collected for me automatically when the appropriate monitoring event fires.  This can be tremendously helpful when it is 3am and I trying to deal with an outage&#8230;not having to remember the exact command line arguments or having a context at the EXACT moment of the event can definitely give operators a leg up in troubleshooting outages.</p>
<p>We will dive into chatops in another article.  If you are running StackStorm supporting your chatops then keep in mind that the integration of StackStorm to your chat is bi-directional so not only would StackStorm post to your chat environment it would also listen to that environment.  Via our “storm bot” integration, any action you can take via the StackStorm CLI can also be taken from your chat environment.</p>
<p>I know that my diagnostic workflow is pretty simple.  With actions written by networking engineering experts or a really good DBA this would be even more valuable.  The power of these diagnostic workflows really come in when you start adding domain knowledge from these various subject matter experts on your team, or even across your IT silos.  As the quality of the actions improve, the richness of the context for the troubleshooting becomes even greater.  Sharing this super rich context around an event in a collaborative fashion such as chat or bug tracking systems is tremendously helpful as is accessing it via StackStorm’s audit capabilities; that sounds like yet another possible subject for a blog post.</p>
<p>Please let me know what you think.  What would make this kind of article more useful?  What other articles would you like to see?  Comment below or find us on our <a href="https://groups.google.com/forum/#!forum/stackstorm">google groups </a>or of course on IRC #stackstorm on freednode.</p>	</div>
	<div class="clear"></div>
	
	
	
				<div class="pnav">
			<a class="pav left" href="../../../../2014/11/20/stackstorm-vs-aws-lambda-event-driven-computing-vs-event-driven-operations/index.html">
				<span>Previous Post</span>
				<span>StackStorm vs. AWS Lambda: Event-Driven Computing vs. Event-Driven Operations</span>
			</a>
			<a class="pav right" href="../../../../2014/11/25/media-alert-stackstorm-to-host-cloud-online-meetup-on-openstack-operations-automation-and-beyond/index.html">
				<span>Next Post</span>
				<span>[Press Release] StackStorm To Host Cloud Online Meetup On OpenStack Operations Automation And Beyond</span>
			</a>
		</div>
	</div>

	
<div id="disqus_thread"></div>
			</section>


		</div>
		<div class="clear"></div>
	

<div class="footer-wrapper">
<footer>
				<div class="fmw">
			<div class="wrp">
									<div class="colm oth ">
						<section id="text-7" class="col"><div class="scn">			<div class="textwidget">
<p><a href="http://docs.stackstorm.com/" target="_blank" rel="noopener">Documentation</a><br>
<a href="https://github.com/StackStorm" target="_blank" rel="noopener">GitHub</a><br>
<a href="../../../../index.html#community" target="_blank" rel="noopener">Community</a><br>
<a href="../../../../security/index.html" target="_blank" rel="noopener">Security</a></p>
</div>
		</div></section>					</div>
									<div class="colm oth ">
						<section id="text-8" class="col"><div class="scn">			<div class="textwidget">
<p><a href="../../../../blog/index.html">Blog</a><br>
<a href="https://www.youtube.com/channel/UCColc5CuBJ8-1SnALnkDz8Q">Video Gallery</a><br>
<a href="../../../../privacy-policy/index.html">Privacy Policy</a></p>
</div>
		</div></section>					</div>
									<div class="colm oth lst">
						<section id="text-9" class="col"><div class="scn">			<div class="textwidget">
<div style="line-height:1.7em;">
<a href="../../../../contact/index.html">Contact</a><br>

<div class="ic-social">
<a href="https://www.facebook.com/stackstormdevops" target="_blank" rel="noopener"><i class="fa fa-facebook-square"></i></a>
<a href="https://twitter.com/StackStorm" target="_blank" rel="noopener"><i class="fa fa-twitter-square"></i></a>
<a href="https://www.linkedin.com/company/stackstorm" target="_blank" rel="noopener"><i class="fa fa-linkedin-square"></i></a>
<a href="https://github.com/StackStorm" target="_blank" rel="noopener"><i class="fa fa-github-square"></i></a>
<a href="https://www.youtube.com/channel/UCColc5CuBJ8-1SnALnkDz8Q" target="_blank" rel="noopener"><i class="fa fa-youtube-square"></i></a>
</div>
</div>
<style type="text/css">.tve-leads-track-ribbon-46 {
  top: 70px !important;
}
.tve-leads-track-ribbon-46 #tve_four_set {
  font-family: 'Open Sans', Helvetica, Arial, Lucida, sans-serif;
}
.tve-leads-track-ribbon-46 #tve_four_set .thrv-ribbon {
border-top: 1px solid #ddd;
    box-shadow: 0px 4px 3px -4px rgba(0,0,0,0.75);
    padding-bottom: 0px !important;
    padding-top: 0px !important;
    border-right: none;
    border-left: none;
}
.tve-leads-track-ribbon-46 .bold_text {
  font-weight: normal;
}
.tve-leads-track-ribbon-46 #tve_four_set .tve-ribbon-close {
height: 30px;
    border-color: white;
    color: white;
    font-family: sans-serif;
    border-width: 2px;
    top: 50%;
    margin-top: -15px;
    font-size: 18px;
    font-weight: 800;
}</style>
</div>
		</div></section>					</div>
								<div class="clear"></div>
			</div>
		</div>
		<div class="fmm">
		<div class="wrp">
			<div class="ft-m">
							</div>
		</div>
		<div class="wrp">
			<div class="ft-c">
				<p>
											© 2021 StackStorm a Series of LF Projects, LLC. All rights reserved. For web site terms of use, trademark policy and other project policies please see <a href="https://lfprojects.org/">https://lfprojects.org/</a>. 
<br>For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage">Trademark Usage</a> page. Linux is a registered trademark of Linus Torvalds.  <a href="https://www.linuxfoundation.org/privacy">Privacy Policy</a> and <a href="https://www.linuxfoundation.org/terms">Terms of Use</a>.														</p>
			</div>
			<div class="ft-s">
												<ul>
																																		</ul>
			</div>
		</div>
		<div class="clear"></div>
	</div>
	</footer>
</div>


<!--googleoff: all--><div id="cookie-law-info-bar" data-nosnippet="true"><span>We use cookies for traffic analytics and ad and content personalization. By clicking on any of the content or interacting with any section of this website,<br>you are agreeing to this use of cookies in the manner described in our <a href="../../../../privacy-policy/index.html" id="CONSTANT_OPEN_URL" target="_blank" class="cli-plugin-main-link" style="display:inline-block;">Privacy Policy</a> <a role="button" tabindex="0" data-cli_action="accept" id="cookie_action_close_header" class="cli-plugin-main-button cookie_action_close_header cli_action_button" style="display:inline-block; ">close [x]</a></span></div>
<div id="cookie-law-info-again" style="display:none;" data-nosnippet="true"><span id="cookie_hdr_showagain">Privacy & Cookies Policy</span></div>
<div class="cli-modal" data-nosnippet="true" id="cliSettingsPopup" tabindex="-1" role="dialog" aria-labelledby="cliSettingsPopup" aria-hidden="true">
  <div class="cli-modal-dialog" role="document">
	<div class="cli-modal-content cli-bar-popup">
	  	<button type="button" class="cli-modal-close" id="cliModalClose">
			<svg class="" viewbox="0 0 24 24"><path d="M19 6.41l-1.41-1.41-5.59 5.59-5.59-5.59-1.41 1.41 5.59 5.59-5.59 5.59 1.41 1.41 5.59-5.59 5.59 5.59 1.41-1.41-5.59-5.59z"></path><path d="M0 0h24v24h-24z" fill="none"></path></svg>
			<span class="wt-cli-sr-only">Close</span>
	  	</button>
	  	<div class="cli-modal-body">
			<div class="cli-container-fluid cli-tab-container">
	<div class="cli-row">
		<div class="cli-col-12 cli-align-items-stretch cli-px-0">
			<div class="cli-privacy-overview">
				<h4>Privacy Overview</h4>				<div class="cli-privacy-content">
					<div class="cli-privacy-content-text">This website uses cookies to improve your experience while you navigate through the website. Out of these, the cookies that are categorized as necessary are stored on your browser as they are essential for the working of basic functionalities of the website. We also use third-party cookies that help us analyze and understand how you use this website. These cookies will be stored in your browser only with your consent. You also have the option to opt-out of these cookies. But opting out of some of these cookies may affect your browsing experience.</div>
				</div>
				<a class="cli-privacy-readmore" aria-label="Show more" tabindex="0" role="button" data-readmore-text="Show more" data-readless-text="Show less"></a>			</div>
		</div>
		<div class="cli-col-12 cli-align-items-stretch cli-px-0 cli-tab-section-container">
												<div class="cli-tab-section">
						<div class="cli-tab-header">
							<a role="button" tabindex="0" class="cli-nav-link cli-settings-mobile" data-target="necessary" data-toggle="cli-toggle-tab">
								Necessary							</a>
							<div class="wt-cli-necessary-checkbox">
                        <input type="checkbox" class="cli-user-preference-checkbox" id="wt-cli-checkbox-necessary" data-id="checkbox-necessary" checked>
                        <label class="form-check-label" for="wt-cli-checkbox-necessary">Necessary</label>
                    </div>
                    <span class="cli-necessary-caption">Always Enabled</span> 						</div>
						<div class="cli-tab-content">
							<div class="cli-tab-pane cli-fade" data-id="necessary">
								<p>Necessary cookies are absolutely essential for the website to function properly. This category only includes cookies that ensures basic functionalities and security features of the website. These cookies do not store any personal information.</p>
							</div>
						</div>
					</div>
																	<div class="cli-tab-section">
						<div class="cli-tab-header">
							<a role="button" tabindex="0" class="cli-nav-link cli-settings-mobile" data-target="non-necessary" data-toggle="cli-toggle-tab">
								Non-necessary							</a>
							<div class="cli-switch">
                        <input type="checkbox" id="wt-cli-checkbox-non-necessary" class="cli-user-preference-checkbox" data-id="checkbox-non-necessary" checked>
                        <label for="wt-cli-checkbox-non-necessary" class="cli-slider" data-cli-enable="Enabled" data-cli-disable="Disabled"><span class="wt-cli-sr-only">Non-necessary</span></label>
                    </div>						</div>
						<div class="cli-tab-content">
							<div class="cli-tab-pane cli-fade" data-id="non-necessary">
								<p>Any cookies that may not be particularly necessary for the website to function and is used specifically to collect user personal data via analytics, ads, other embedded contents are termed as non-necessary cookies. It is mandatory to procure user consent prior to running these cookies on your website.</p>
							</div>
						</div>
					</div>
										</div>
	</div>
</div>
	  	</div>
	  	<div class="cli-modal-footer">
			<div class="wt-cli-element cli-container-fluid cli-tab-container">
				<div class="cli-row">
					<div class="cli-col-12 cli-align-items-stretch cli-px-0">
						<div class="cli-tab-footer wt-cli-privacy-overview-actions">
						
															<a id="wt-cli-privacy-save-btn" role="button" tabindex="0" data-cli-action="accept" class="wt-cli-privacy-btn cli_setting_save_button wt-cli-privacy-accept-btn cli-btn">SAVE & ACCEPT</a>
													</div>
						
					</div>
				</div>
			</div>
		</div>
	</div>
  </div>
</div>
<div class="cli-modal-backdrop cli-fade cli-settings-overlay"></div>
<div class="cli-modal-backdrop cli-fade cli-popupbar-overlay"></div>
<!--googleon: all--><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">/**
 * Displays toast message from storage, it is used when the user is redirected after login
 */
if ( window.sessionStorage ) {
	window.addEventListener( 'load', function () {
		var message = sessionStorage.getItem( 'tcb_toast_message' );

		if ( message ) {
			tcbToast( sessionStorage.getItem( 'tcb_toast_message' ), false );
			sessionStorage.removeItem( 'tcb_toast_message' );
		}
	} );
}

/**
 * Displays toast message
 */
function tcbToast( message, error, callback ) {
	/* Also allow "message" objects */
	if ( typeof message !== 'string' ) {
		message = message.message || message.error || message.success;
	}
	if ( ! error ) {
		error = false;
	}

	let _icon = 'checkmark',
		_extra_class = '';
	if ( error ) {
		_icon = 'cross';
		_extra_class = ' tve-toast-error';
	}

	jQuery( 'body' ).slideDown( 'fast', function () {
		jQuery( 'body' ).prepend( '<div class="tvd-toast tve-fe-message"><div class="tve-toast-message"><div class="tve-toast-icon-container' + _extra_class + '"><span class="tve_tick thrv-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" class="tcb-checkmark" style="width: 100%; height: 1em; stroke-width: 0; fill: #ffffff; stroke: #ffffff;" viewBox="0 0 32 32"><path d="M27 4l-15 15-7-7-5 5 12 12 20-20z"><\/path><\/svg><\/span><\/div><div class="tve-toast-message-container">' + message + '<\/div><\/div><\/div>' );
	} );

	setTimeout( function () {
		jQuery( '.tvd-toast' ).hide();

		if ( typeof callback === 'function' ) {
			callback();
		}

	}, 3000 );
}
</script><link rel="stylesheet" id="jcarouselresponsive-css" href="../../../../wp/wp-content/plugins/easy-logo-slider/css/jcarouselresponsive.css?ver=09e48cfb58fec140b4ee0c6d1d4da1b2" type="text/css" media="all">
<link rel="stylesheet" id="style-admin-css" href="../../../../wp/wp-content/plugins/easy-logo-slider/css/style-admin.css?ver=09e48cfb58fec140b4ee0c6d1d4da1b2" type="text/css" media="all">
<script type="text/javascript" id="disqus_count-js-extra">
/* <![CDATA[ */
var countVars = {"disqusShortname":"stackstorm"};
/* ]]> */
</script>
<script type="text/javascript" src="../../../../wp/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.22" id="disqus_count-js"></script>
<script type="text/javascript" id="disqus_embed-js-extra">
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.22"},"disqusIdentifier":"1956 http:\/\/stackstorm.com\/?p=1956","disqusShortname":"stackstorm","disqusTitle":"StackStorm – Automated Troubleshooting","disqusUrl":"\/2014\/11\/25\/stackstorm-automated-troubleshooting\/","postId":"1956"};
/* ]]> */
</script>
<script type="text/javascript" src="../../../../wp/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.22" id="disqus_embed-js"></script>
<script type="text/javascript" id="thrive-main-script-js-extra">
/* <![CDATA[ */
var ThriveApp = {"ajax_url":"\/wp\/wp-admin\/admin-ajax.php","is_singular":"1","post_type":"post","lazy_load_comments":"0","comments_loaded":"0","theme_uri":"\/wp\/wp-content\/themes\/rise","translations":{"ProductDetails":"Product Details"}};
/* ]]> */
</script>
<script type="text/javascript" src="../../../../wp/wp-content/themes/rise/js/script.js?v=1.101.1" id="thrive-main-script-js"></script>
<script type="text/javascript" id="tve-dash-frontend-js-extra">
/* <![CDATA[ */
var tve_dash_front = {"ajaxurl":"\/wp\/wp-admin\/admin-ajax.php","force_ajax_send":"","is_crawler":"1","recaptcha":[]};
/* ]]> */
</script>
<script type="text/javascript" src="../../../../wp/wp-content/themes/rise/thrive-dashboard/js/dist/frontend.min.js?ver=2.4.0.1" id="tve-dash-frontend-js"></script>
<script type="text/javascript" src="../../../../wp/wp-content/plugins/enlighter/cache/enlighterjs.min.js?ver=c8vUwCl5jS8Iu00" id="enlighterjs-js"></script>
<script type="text/javascript" id="enlighterjs-js-after">
!function(e,n){if("undefined"!=typeof EnlighterJS){var o={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":2,"ampersandCleanup":true,"linehover":true,"rawcodeDbclick":false,"textOverflow":"break","linenumbers":false,"theme":"beyond","language":"python","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""}};(e.EnlighterJSINIT=function(){EnlighterJS.init(o.selectors.block,o.selectors.inline,o.options)})()}else{(n&&(n.error||n.log)||function(){})("Error: EnlighterJS resources not loaded yet!")}}(window,console);
</script>
<script type="text/javascript" src="../../../../wp/wp-includes/js/wp-embed.min.js?ver=09e48cfb58fec140b4ee0c6d1d4da1b2" id="wp-embed-js"></script>
<script type="text/javascript">var tcb_post_lists=JSON.parse('[]');</script>
</div>
</body>
</html>