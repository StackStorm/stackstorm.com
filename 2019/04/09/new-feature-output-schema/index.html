<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>New Feature: Output Schema | StackStorm</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content="April 9, 2019
by Lindsay Hill
We added support for Output Schema in StackStorm 2.9. This feature has been “under the radar” for a while. Time to shed a little light, explain what it is, how to use it, and why we added this feature. Read on!">
<meta name=generator content="Hugo 0.89.2">
<meta name=ROBOTS content="NOINDEX, NOFOLLOW">
<link rel=stylesheet href=/stackstorm.com/ananke/css/main.min.css>
<meta property="og:title" content="New Feature: Output Schema">
<meta property="og:description" content="April 9, 2019
by Lindsay Hill
We added support for Output Schema in StackStorm 2.9. This feature has been “under the radar” for a while. Time to shed a little light, explain what it is, how to use it, and why we added this feature. Read on!">
<meta property="og:type" content="article">
<meta property="og:url" content="https://stackstorm.github.io/stackstorm.com/2019/04/09/new-feature-output-schema/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2019-04-10T01:28:58+00:00">
<meta property="article:modified_time" content="2019-04-10T01:28:58+00:00">
<meta itemprop=name content="New Feature: Output Schema">
<meta itemprop=description content="April 9, 2019
by Lindsay Hill
We added support for Output Schema in StackStorm 2.9. This feature has been “under the radar” for a while. Time to shed a little light, explain what it is, how to use it, and why we added this feature. Read on!"><meta itemprop=datePublished content="2019-04-10T01:28:58+00:00">
<meta itemprop=dateModified content="2019-04-10T01:28:58+00:00">
<meta itemprop=wordCount content="524">
<meta itemprop=keywords content="actions,output schema,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="New Feature: Output Schema">
<meta name=twitter:description content="April 9, 2019
by Lindsay Hill
We added support for Output Schema in StackStorm 2.9. This feature has been “under the radar” for a while. Time to shed a little light, explain what it is, how to use it, and why we added this feature. Read on!">
</head>
<body class="ma0 avenir bg-near-white">
<header>
<div class=bg-black>
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a href=/stackstorm.com/ class="f3 fw2 hover-white no-underline white-90 dib">
StackStorm
</a>
<div class="flex-l items-center">
</div>
</div>
</nav>
</div>
</header>
<main class=pb7 role=main>
<article class="flex-l flex-wrap justify-between mw8 center ph3">
<header class="mt4 w-100">
<aside class="instapaper_ignoref b helvetica tracked">
POSTS
</aside>
<div id=sharing class=mt3>
<a href="https://www.facebook.com/sharer.php?u=https://stackstorm.github.io/stackstorm.com/2019/04/09/new-feature-output-schema/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a>
<a href="https://twitter.com/share?url=https://stackstorm.github.io/stackstorm.com/2019/04/09/new-feature-output-schema/&text=New%20Feature:%20Output%20Schema" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https://stackstorm.github.io/stackstorm.com/2019/04/09/new-feature-output-schema/&title=New%20Feature:%20Output%20Schema" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
</div>
<h1 class="f1 athelas mt3 mb1">New Feature: Output Schema</h1>
<p class=tracked>
By <strong>
st2admin
</strong>
</p>
<time class="f6 mv4 dib tracked" datetime=2019-04-10T01:28:58Z>April 10, 2019</time>
</header>
<div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p><em>April 9, 2019</em><br>
<em>by Lindsay Hill</em></p>
<p>We added support for <a href=https://docs.stackstorm.com/latest/actions.html#output-schema>Output Schema</a> in StackStorm 2.9. This feature has been “under the radar” for a while. Time to shed a little light, explain what it is, how to use it, and <strong>why</strong> we added this feature. Read on!</p>
<h2 id=output-schema-8211-whats-that>Output Schema – What’s That?</h2>
<p>Anyone who has created their own custom <a href=https://docs.stackstorm.com/actions.html>StackStorm action</a> knows all about adding parameters. This defines the expected parameters and their type. For example, the <code>&lt;a href="https://github.com/StackStorm/st2/blob/master/contrib/examples/actions/orquesta-basic.yam">examples.orquesta-basic&lt;/a></code> action has this:</p>
<p>We define the <em>input</em> structure, but we have not defined the <em>output</em> structure. Our action is free to return whatever it wants. This is particularly important for Python actions, which can return any custom object they want.</p>
<p>That’s no big deal when you’re running a single action. But when you are combining multiple actions into a workflow, it’s <em>really, really</em> useful to know what one action’s output looks like, so you can then use it in another action.</p>
<p>That’s where Output Schema comes in. It lets us define the expected structure of our action <em>outputs</em>.</p>
<h2 id=ok-so-how-do-i-use-it>OK, so How Do I Use It?</h2>
<p>The first thing we need to do is enable schema validation. In current versions, this is disabled by default.</p>
<p>Edit <code>/etc/st2/st2.conf</code>, and set this:</p>
<p>Restart all services (<code>sudo st2ctl restart</code>).</p>
<p>We’re going to use this simple python action for testing:</p>
<p>You can see that it will normally return a result object with a <code>version</code> and an <code>executable</code> string.</p>
<p>So let’s use this metadata:</p>
<p>Register the action, then run it.</p>
<p>OK, all good so far.</p>
<p>What happens if we change our <code>return:</code> line in the Python code?</p>
<p>Let’s make it this:</p>
<p>Note how we’re just returning <code>version</code> now.</p>
<p>You can see that schema validation failed – <code>executable</code> is a required property, and we didn’t get that in the result object. So the action failed. If this was part of a workflow, it would take the failure path for that task, or if no failure path was defined, the whole workflow would fail.</p>
<h2 id=whats-the-point>What’s the Point?</h2>
<p>Doesn’t this just add complexity? More config to add when creating a new action?</p>
<p>Yes – but it is for good reasons. Defining the expected output structure lets us do two things:</p>
<ol>
<li>Detect errors earlier, so a workflow can fail when actions don’t behave as expected. The earlier you pick up the error, the less it propagates.</li>
<li>If we know the structure of an action’s <em>outputs</em>, we can make it easier to map those to <em>inputs</em> in the next action in our workflow. If you’re creating a workflow in Workflow Designer today, you need to know what the output structure looks like. If this is predefined, we can make this mapping much easier. Watch out for this in a future Workflow Designer update.</li>
</ol>
<h2 id=whats-next>What’s Next?</h2>
<p>Watch out for <code>output_schema</code> to start popping up in packs on <a href=https://exchange.stackstorm.org>StackStorm Exchange</a>. Try it out with your own packs too. <a href=https://forum.stackstorm.com>Let us know</a> if you run into any problems.</p>
<p>In future we will enable output schema validation by default. This will be well-signposted when we do so. We’ll also continue to ignore actions that don’t have any output schema defined.</p><ul class=pa0>
<li class=list>
<a href=/stackstorm.com/tags/actions class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">actions</a>
</li>
<li class=list>
<a href=/stackstorm.com/tags/output-schema class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">output schema</a>
</li>
</ul>
<div class="mt6 instapaper_ignoref">
</div>
</div>
<aside class="w-30-l mt6-l">
<div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
<p class="f5 b mb3">Related</p>
<ul class="pa0 list">
<li class=mb2>
<a href=/stackstorm.com/2015/10/01/octopusdeploy-integration-with-stackstorm/>OctopusDeploy Integration with StackStorm</a>
</li>
</ul>
</div>
</aside>
</article>
</main>
<footer class="bg-black bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://stackstorm.github.io/stackstorm.com>
&copy; StackStorm 2021
</a>
<div>
</div>
</div>
</footer>
</body>
</html>